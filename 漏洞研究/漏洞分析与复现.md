---
tags: 漏洞分析
spec-version: v0.2.10
doc-version: v0.1.0 
---

# 漏洞分析与复现模板

在[开源软件安全研究方法](https://ssst0n3.github.io/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95.html)一文中，我们提到, 漏洞复现工作需要有规范的、成体系的进行。

> 1. 有规范的、成体系的分析、复现并存留实验环境，可以利用vagrant或docker记录、分享漏洞环境。
> 2. 不只是复现漏洞，更重要的是复现漏洞挖掘的方法或过程（能应用于同类漏洞挖掘）

本文将具体提出一个漏洞分析与复现过程中，要做的事情的模板。与前文同样，本文仅列举需要做哪些工作，并未指出具体应怎么做。在我历史及未来关于历史漏洞分析与复现的文章中，可以看到关于本文实际应用的实例。

## 一、基本信息
| Item                         | Details                                          | Note                                        |
|------------------------------|--------------------------------------------------|---------------------------------------------|
| Project                      | [link]()                                         |
| Confirm Link                 | [link]()                                         |
| CVE-ID                       | CVE-0000-0000                                    | [mitre](), [cvedetails]()                   |
| Vuln's Author                | author@org                                       | [github](http://github.com/xxx),[twitter]() |
| CVSS                         | 0.0 CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L |
| EDB-ID                       | [EDB-00000]()                                    | 
| Exploits                     | [exp1]()<br>[exp2]()                             |
| Affect Version               | 0.0.0-9.9.9                                      |
| Fix Version                  | 0.0.0, 1.1.1                                     |
| Fix Commit                   | [commit]()                                       |
| Introduce Commit             | [commit]()                                       | 
| Publish Date                 | 1970-01-01                                       |
| Introduce Date               | 1970-01-01                                       |
| Intelligence Gathering Date  | 1970-01-01                                       |

## 二、组件简介

把组件、组件涉及的功能简单介绍下

## 三、漏洞作者
### 1. discoverer: [Person Name]

[Person Name] is ...

`![](photo)`

| Item             | Link      | Note |
|------------------|-----------|------|
| author           |
| organization     |
| github           |
| gitlab           |
| email            |
| website          | [title]() |
| social media     | -         | -    |
| twitter          |
| mastodon         |
| telegram         |
| reddit           |
| facebook         |
| hackmd           |
| youtube          |
| linkedin         |
| medium           |
| cve              |
| acknowledgements |
| presents         |
| slideshare       |
| ctf              |
| paper            |
| book             |
| other            |

> This section use [Cloud Native Security News: Researcher Introduction](https://github.com/ssst0n3/security-research-specification/blob/main/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/researcher-introduction.md) as template.

### 2. introducer: [Person Name]

历史上引入过漏洞的开发者，可能未来引入漏洞的概率也较大。

如果多个漏洞都指向同一个作者，则有必要对其提交的代码开展深入研究。如果仅有一个漏洞，暂时不必过度关注，简单记录信息即可。

e.g.: 

| Role      | Person                                  | Contribution                               | Commits under runC                                               |
|-----------|-----------------------------------------|--------------------------------------------|------------------------------------------------------------------|
| Author    | [Name `<email>`](https://github.com/ID) | #60 94 commits    5,068 ++    1,181 --     | [commits](https://github.com/gitgitgadget/git/commits?author=id) |
| Co-Author | [Name `<email>`](https://github.com/ID) | #4 1,873 commits    57,204 ++    46,588 -- | too much                                                         |

### 3. fixer: [Person Name]
  
历史上修复过漏洞的开发者，可能未来也会修复漏洞。关注他的commit记录，可能会提前感知到漏洞。
  
e.g.:
  
| Role      | Person                                  | Contribution                               | Commits under runC                                               |
|-----------|-----------------------------------------|--------------------------------------------|------------------------------------------------------------------|
| Author    | [Name `<email>`](https://github.com/ID) | #60 94 commits    5,068 ++    1,181 --     | [commits](https://github.com/gitgitgadget/git/commits?author=id) |
| Co-Author | [Name `<email>`](https://github.com/ID) | #4 1,873 commits    57,204 ++    46,588 -- | too much                                                         |

## 四、漏洞详情
### 1. 介绍

#### 1.1 原始特性

#### 1.2 漏洞介绍

### 2. 影响

#### 2.1 范围

#### 2.2 危害

危害xxx

**CVSS：**

对于场景 xxx：[0.0 CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

| vector              | score                           | reason |
|---------------------|---------------------------------|--------|
| Attack Vector       | Network/Adjacent/Local/Physical | xxx    |
| Attack Complexity   | Low/High                        |        |
| Privileges Required | None/Low/High                   |        |
| User Interaction    | None/Required                   |        |
| Scope               | Unchanged/Changed               |        |
| Confidentiality     | None/Low/High                   |        |
| Integrity           | None/Low/High                   |        |
| Availability        | None/Low/High                   |        |

#### 2.3 利用场景

## 五、防御

### 1. 修复建议

### 2. 规避措施

### 3. 检测

## 六、漏洞复现

### 1. 复现环境

### 2. 漏洞复现


## 七、漏洞分析

### 1. 原始特性分析 [Optional]

原始功能是有什么用，怎么使用的。

### 2. 调用链分析

### 3. 漏洞分析

### 4. poc构造 [Optional]

描述以下内容：

* poc
* 构造过程
* poc如何改造 [Optional]

## 八、漏洞修复分析
### 1. 修复分析

### 2. 修复效果验证

### 3. 当前修复局限性

### 4. 该修复有无引入新漏洞

因漏洞修复的作者水平参差不齐：
1. 作者可能不是核心开发者
2. 作者非安全背景

漏洞修复引入新漏洞的案例屡见不鲜，应引入这一环节

## 九、漏洞挖掘方法与过程

### 1. 原作者的漏洞挖掘方法
* 如果可以推测原作者的漏洞挖掘方法的话，可以记录; 如果没有可以忽略

### 2. 有无可能早于作者或业界发现
例如，漏洞修复的commit早于漏洞公告等情况


## 十、同类问题挖掘方法
| level  | 挖掘方法 |
|--------|------|
| 设计层    |      |
| 安全模型   |      |
| Fuzz   |      |
| codeql |      |

## 十一、漏洞情报

### 1. 如何获知本漏洞情报

### 2. 有无自动化手段发现

## 十二、总结

## 十三、遗留事项

待后续研究，但与漏洞分析关联性不是特别的大的工作，例如：
- [ ] 对漏洞引入者的跟踪：漏洞线索感知
- [ ] 对漏洞发现者的跟踪：快速感知漏洞
- [ ] 对漏洞修复者的跟踪：隐秘修复检测

## 附

### 时间线
漏洞产生、发现、报告、修复、分析的时间线

e.g. containerd CVE-2022-23648 的时间线:
* 2021-11-22 作者Felix Wilhelm向containerd报告
* 2022-02-18 containerd要求宽限至3月7日公开
* 2022-03-03 containerd完成修复，并在GHSA发布漏洞通告
* 2022-03-04 我人工查阅GHSA捕获到漏洞情报
* 2022-03-07 我完成漏洞复现
* 2022-03-24 Google Project Zero 因达到90+30天期限公开漏洞报告
* 2022-03-26 我完成主要内容分析，主要时间花在调用链分析上
* 2022-03-29 博客公开本文
* 2022-04-27 公众号发布本文

### 参考链接
